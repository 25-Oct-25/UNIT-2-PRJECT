{% load static %}
<!DOCTYPE html>
<!-- نحدد الثيم من الكوكيز -->
<html lang="en" data-theme="{% if request.COOKIES.theme == 'dark' %}dark{% else %}light{% endif %}">
<head>
  <!-- إعدادات الصفحة -->
  <meta charset="UTF-8">
  <!-- عشان لما أفتح الموقع من الجوال يطلع مضبوط -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Saudi Resilience{% endblock %}</title>

  <!-- بوتستراب -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

  <!-- ايقونات بوتستراب -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  <!-- ملف التنسيق الاساسي -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">

  {% block extra_css %}{% endblock %}
</head>
<body>

  <!-- شريط التنقل -->
  <nav class="navbar navbar-expand-lg fixed-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="{% url 'main:home_view' %}">Saudi Resilience</a>

      <!-- زر القائمة للجوال -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navMain">
        <ul class="navbar-nav ms-auto">

          {% with current=request.resolver_match.url_name %}
          
          <!-- الهوم -->
          <li class="nav-item">
            <a class="nav-link {% if current == 'home_view' %}active{% endif %}" href="{% url 'main:home_view' %}">Home</a>
          </li>

          <!-- الأقسام -->
          <li class="nav-item dropdown">
            <!-- نخلي زر المنيو يصير active لو احنا باي قطاع -->
            <a class="nav-link dropdown-toggle {% if current == 'health_view' or current == 'education_view' or current == 'economy_view' or current == 'technology_view' %}active{% endif %}"
             href="#" data-bs-toggle="dropdown">Sectors</a>

            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item {% if current == 'health_view' %}active{% endif %}" href="{% url 'main:health_view' %}">Health</a></li>
              <li><a class="dropdown-item {% if current == 'education_view' %}active{% endif %}" href="{% url 'main:education_view' %}">Education</a></li>
              <li><a class="dropdown-item {% if current == 'economy_view' %}active{% endif %}" href="{% url 'main:economy_view' %}">Economy</a></li>
              <li><a class="dropdown-item {% if current == 'technology_view' %}active{% endif %}" href="{% url 'main:technology_view' %}">Technology</a></li>
            </ul>
          </li>

          <!-- باقي الصفحات -->
          <li class="nav-item">
            <a class="nav-link {% if current == 'vision_view' %}active{% endif %}" href="{% url 'main:vision_view' %}">Vision 2030</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if current == 'about_view' %}active{% endif %}" href="{% url 'main:about_view' %}">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if current == 'film_view' %}active{% endif %}" href="{% url 'main:film_view' %}">Film</a>
          </li>
          <li class="nav-item">
             <a class="nav-link {% if current == 'contact_view' %}active{% endif %}" href="{% url 'main:contact_view' %}">Contact</a>
          </li>

          <!-- زر تغيير الثيم عن طريق الكوكيز -->
          <li class="nav-item">
            {% if request.COOKIES.theme == 'dark' %}
              <!-- لو الوضع دارك نعرض شمس -->
              <a class="nav-link" href="{% url 'main:set_theme_view' 'light' %}" title="Light mode">
                <i class="bi bi-sun-fill"></i>
              </a>
            {% else %}
              <!-- لو الوضع لايت نعرض هلال -->
              <a class="nav-link" href="{% url 'main:set_theme_view' 'dark' %}" title="Dark mode">
                <i class="bi bi-moon-fill"></i>
              </a>
            {% endif %}
          </li>

          {% endwith %}
        </ul>
      </div>
    </div>
  </nav>

  <!-- المحتوى -->
  <main>
    {% block content %}{% endblock %}
  </main>

  <!-- الفوتر -->
  <footer class="py-3 text-center small mt-3 bg-white border-top">
    © Saudi Resilience 2025 — Designed by Maha Saud
  </footer>

  <!--  mt-3 جافا سكربت بوتستراب -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- حركة ظهور المحتوى بالتدريج -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const items = document.querySelectorAll('.reveal')
    const io = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting){
          entry.target.classList.add('visible')
          observer.unobserve(entry.target)
        }
      })
    }, { threshold: 0.15 }) // 0.15 = يعني يبدأ التأثير بدخول 15% من العنصر
    items.forEach(el => io.observe(el))
  })
  </script>

</body>
</html>